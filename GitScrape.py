from bs4 import BeautifulSoup
import requests
from github import Github
from time import sleep
from keywords import keywords
import logging
from datetime import datetime
import argparse
import threading
from concurrent.futures import ThreadPoolExecutor, as_completed

queries = ['equifax',
    'aa.econsumer.equifax.com','aarp-prod1.trustedid.wip.equifax.com','aarpimages-prod1.trustedid.wip.equifax.com','aarpimages-prod3.trustedid.wip.equifax.com','accelerate.equifax.com','accesspoint-ca.ext.gslb.us.equifax.com','accesspoint-pa.equifax.com','accesspoint-pa.ext.gslb.us.equifax.com','accesspoint.equifax.com','accesspoint.ext.gslb.au.equifax.com','accesspoint.ext.gslb.us.equifax.com','accesspoint.uk.equifax.com','account-acquisition.equifax.com','account-management.equifax.com','ai.equifax.com','ajc1.equifax.com','ajc2.ext.gslb.us.equifax.com','ajc2.us.equifax.com','alp01.snr.equifax.com','amd2.fin.equifax.com','anakam.equifax.com','api.auth-router.mobileconnect.equifax.com','api.auth.mobileconnect.equifax.com','api.baas.ext.gslb.us.equifax.com','api.consumer.equifax.com','api.dev.securev2.instatouch.ext.gslb.us.equifax.com','api.digitalid.mobileconnect.equifax.com','api.econsumer.equifax.com','api.instatouch.equifax.com','api.load.securev2.instatouch.ext.gslb.us.equifax.com','api.load.transaction.instatouch.ext.gslb.us.equifax.com','api.mortgage.equifax.com','api.qa.securev2.instatouch.ext.gslb.us.equifax.com','api.secure.instatouch.equifax.com','api.securev2.instatouch.ext.gslb.us.equifax.com','api.supplier.equifax.com','api.transaction.instatouch.ext.gslb.us.equifax.com','api.uat.equifax.com','apis.equifax.com','app.inform.equifax.com','app.solutions-ca.equifax.com','app.uk.partner.equifax.com','app.workforce.equifax.com','app1.paynet.equifax.com','app2.atl.ec.equifax.com','app402.atl.ec.equifax.com','app505.atl.ec.equifax.com','app506.atl.ec.equifax.com','app512.atl.ec.equifax.com','app513.atl.ec.equifax.com','app600.atl.ec.equifax.com','app601.atl.ec.equifax.com','app602.atl.ec.equifax.com','app603.atl.ec.equifax.com','app604.atl.ec.equifax.com','app63.atl.ec.equifax.com','app67.atl.ec.equifax.com','app68.atl.ec.equifax.com','app69.atl.ec.equifax.com','app70.atl.ec.equifax.com','app71.atl.ec.equifax.com','app710.atl.ec.equifax.com','app714.atl.ec.equifax.com','app72.atl.ec.equifax.com','app73.atl.ec.equifax.com','app74.atl.ec.equifax.com','app78.atl.ec.equifax.com','app79.atl.ec.equifax.com','aps.ext.gslb.us.equifax.com','aspire.ct.equifax.com','aspire.equifax.com','assets.equifax.com','atl0-biz-p1-www.ai.equifax.com','atlaccess.equifax.com','atlassoa.cps-dev.equifax.com','atlassoa.cps-prod.equifax.com','atlassoa.cps-qa.equifax.com','atlassoa.cps-qa2.equifax.com','atlassoa.cps-qa3.equifax.com','atlassoa.cps-qa4.equifax.com','atlassoa.cps-run.equifax.com','atlassoa.cps-stg.equifax.com','atlassoa.cps-uat.equifax.com','atlassoa.cps-uat101.equifax.com','atlassoa.cps-uat104.equifax.com','atlassoa01.cps-dev.equifax.com','atllyncextws.equifax.com','attcas.ic-sts.ext.equifax.com','attcas.ic-sts.ext.ext.gslb.us.equifax.com','attcas.ic-sts.ext.wip.equifax.com','attcas.ic-uat-sts.ext.ext.gslb.us.equifax.com','attcas.ic-uat-sts.ext.wip.equifax.com','attcas.ic-uat.ext.ext.gslb.us.equifax.com','attcas.ic-uat.ext.wip.equifax.com','attcas.interconnect.equifax.com','attcas.interconnect.ext.gslb.us.equifax.com','attcas.interconnect.wip.equifax.com','attcaslite.interconnect.equifax.com','attcrsm.icsaas.ext.gslb.us.equifax.com','auth-uat.equifax.com','auth.au.equifax.com','auth.au.prod.ext.gslb.au.equifax.com','auth.ca.equifax.com','auth.dr.uk.equifax.com','auth.equifax.com','auth.ext.gslb.us.equifax.com','auth.stl.equifax.com','auth.uat.uk.equifax.com','auth.uk.equifax.com','auth.wip.equifax.com','auth0.atl.ec.equifax.com','auth0.atl.equifax.com','auth1.atl.ec.equifax.com','auth1.atl.equifax.com','auth14.yul.equifax.com','auth15.yul.equifax.com','auth2.atl.ec.equifax.com','auth2.ca.ext.gslb.us.equifax.com','auth2.equifax.com','auth2.ext.gslb.us.equifax.com','auth2.in.ext.gslb.us.equifax.com','auth2.uat.uk.equifax.com','auth2.uk.equifax.com','auth3.atl.ec.equifax.com','auth3.equifax.com','auth3.ext.gslb.us.equifax.com','auth3.wip.equifax.com','auth4.atl.ec.equifax.com','auth4.ext.gslb.us.equifax.com','auth5.atl.ec.equifax.com','authsvc-beta.equifax.com','authsvc.equifax.com','autoconnect-uat.equifax.com','autoconnect.equifax.com','auvpn.ext.gslb.au.equifax.com','avvppi03.equifax.com','avvppi04.equifax.com','avvppi05.equifax.com','avvppi06.equifax.com','avvppi07.equifax.com','awap.equifax.com','awxfeatlmag.snr.equifax.com','awxfelbaseg.snr.equifax.com','awxfeseg.snr.equifax.com','awxfestlmag.snr.equifax.com','awxfestlseg.snr.equifax.com','awxfesydseg.snr.equifax.com','ayuda.equifax.com','b1gtmweb1.wip.equifax.com','backup.interconnect.equifax.com','baiada-eapps.ext.gslb.au.equifax.com','banking.icsaas.equifax.com','banking.icsaas.ext.gslb.us.equifax.com','bestpractices.equifax.com','beta.developer.equifax.com','beta.econsumer.equifax.com','bi.equifax.com','bi1.ignitemarketplace.au.equifax.com','billmelaterphoenix1.fin.equifax.com','blog.equifax.com','broadway.equifax.com','brokerage.icsaas.equifax.com',
    'brokerage.icsaas.ext.gslb.us.equifax.com','c.equifax.com','ca.accesspoint.ext.gslb.au.equifax.com','ca.accesspoint.uk.equifax.com','canadaca.atl.ec.equifax.com','careers.equifax.com','cd.equifax.com','cd.fin.equifax.com','cdc.equifax.com','cdcecrunch.equifax.com','cdcgreycon.equifax.com','cdcinfo.equifax.com','central.equifax.com','cert.ea.equifax.com','cis1.fin.equifax.com','ckarma-eid.equifax.com','ckarma-eiduat.equifax.com','ckarma-ists.equifax.com','ckarma-test.equifax.com','claims.uat.uk.equifax.com','claims.uk.equifax.com','click.e.equifax.com','click.e.uk.equifax.com','click.notify.equifax.com','clientid.ext.gslb.au.equifax.com','cml-medical.prod.dms.equifax.com','cml.prod.dms.equifax.com','cof.icsaas.ext.gslb.us.equifax.com','collaborate.equifax.com','collections.equifax.com','commercial-intl-uat.equifax.com','commercial-intl.equifax.com','commercial-ppe-uat.equifax.com','commercial-ppe.equifax.com','commercial.equifax.com','compliance.equifax.com','connect-uat.emortgage.equifax.com','connect.emortgage.equifax.com','consumer.equifax.com','consumer.verificationexchange.ext.gslb.au.equifax.com','convergys2.fin.equifax.com','cool.equifax.com','corpconnector.equifax.com','cps.ic.equifax.com','cps.interconnect.equifax.com','cps.interconnect.sts.equifax.com','cpsext.interconnect.equifax.com','cpslite.interconnect.equifax.com','credit.equifax.com','creditwatch.equifax.com','ct.evsportal.equifax.com','ct.evssvc1.equifax.com','ct.evssvc2.equifax.com','ct.integrated.verificationservices.equifax.com','custconnector.equifax.com','cyber.mtk.ext.gslb.us.equifax.com','dapapphost.ca.equifax.com','dapapphost.dev.ca.equifax.com','dapweb.ca.equifax.com','dapweb.dev.ca.equifax.com','dashboard-int.intellireal.ext.gslb.us.equifax.com','dashboard.intellireal.ext.gslb.us.equifax.com','datadrivenmarketing.equifax.com','davinci.equifax.com','dealertrack-ists.equifax.com','decisionportal-uat.equifax.com','decisionportal.equifax.com','demo-decisionpoint3.ext.gslb.au.equifax.com','demo.cms.equifax.com','dev.complianceconnect.equifax.com','dev.dapapphost.ca.equifax.com','dev.dapweb.ca.equifax.com','dev.gfsawsaia.ext.gslb.us.equifax.com','dev.itg.equifax.com','dev.lockandalert.ext.gslb.us.equifax.com','dev.microservices.ext.gslb.au.equifax.com','dev.mockicappclient.ca.equifax.com','dev.ms.icsaas.ext.gslb.us.equifax.com','dev.ui.attcrsm.icsaas.equifax.com','dev.ui.attcrsm.icsaas.ext.gslb.us.equifax.com','dev1.atl.ec.equifax.com','devapi.econsumer.equifax.com','devapis.equifax.com','developer.equifax.com','developer.ext.gslb.au.equifax.com','developerkb.equifax.com','devweb-creditworks.ext.gslb.au.equifax.com','dish.ic-prod-sts.ext.equifax.com','dish.ic-prod-sts.ext.ext.gslb.us.equifax.com','dish.ic-prod-ui.ext.equifax.com','dish.ic-prod-ui.ext.ext.gslb.us.equifax.com','dish.ic-prod-ui.ext.wip.equifax.com','dish.ic-uat-sts.ext.equifax.com','dish.ic-uat-ui.ext.equifax.com','dish.ic-uat-ui.ext.ext.gslb.us.equifax.com','dm2.atl.ec.equifax.com','dm4.atl.ec.equifax.com','dm6.atl.ec.equifax.com','dm7.atl.ec.equifax.com','dmsconversion.dms.equifax.com','dmsinstftp01.dms.equifax.com','dod.equifax.com','dod.ext.gslb.us.equifax.com','dr-test.ecommercial.equifax.com','dr-test.eport.equifax.com','dr-test.ists.equifax.com.equifax.com','dr.ic.uk.equifax.com','drconnect.emortgage.equifax.com','drcps.interconnect.equifax.com','drcps.interconnect.sts.equifax.com','dremort.equifax.com','dremortgage.equifax.com','dremployment.mconnect.equifax.com','dremsops.emortgage.equifax.com','dremsws.equifax.com','drtest.interconnect.equifax.com','dtv.interconnect.equifax.com','dtv.interconnect.ext.gslb.us.equifax.com','dtv.interconnect.wip.equifax.com','ea.equifax.com','ebanking.equifax.com','ebsiportal.equifax.com','ebsiportaldev.ext.gslb.us.equifax.com','ebsiportalsit.ext.gslb.us.equifax.com','ebsiportaluat.ext.gslb.us.equifax.com','ecommercial-agreements-uat.eport.equifax.com','ecommercial-agreements.eport.equifax.com','ecommercial-uat.equifax.com','ecommercial-uat.ext.gslb.us.equifax.com','ecommercial.equifax.com','econsumer.equifax.com','edge.equifax.com','edt.atl.ec.equifax.com','edt.ec.equifax.com','emort.equifax.com','emortgage-uat.ext.gslb.us.equifax.com','emortgage.equifax.com','employment-uat.mconnect.equifax.com','employment-uat.mconnect.ext.gslb.us.equifax.com','employment.mconnect.equifax.com','employment.mconnect.ext.gslb.us.equifax.com','emscert.equifax.com','emsops-uat.emortgage.equifax.com','emsops.emortgage.equifax.com','emsops.emortgage.ext.gslb.us.equifax.com','emsws-uat.ext.gslb.us.equifax.com','emsws.equifax.com','emsws.ext.gslb.us.equifax.com','enable.equifax.com','eport.equifax.com','eportcert.equifax.com','eportcms.equifax.com','eportuat.equifax.com','equicom.econsumer.equifax.com','equifax.com','equifaxlaw.equifax.com','equip.uk.equifax.com','espanol.equifax.com','eu.equifax.com','ews.equifax.com','excasa.equifax.com',
    'excasb.equifax.com','experian-uat.referral.equifax.com','experian.referral.equifax.com','experian.referral.ext.gslb.us.equifax.com','externalidp.equifax.com','extranet.cis.equifax.com','fact.econsumer.equifax.com','facta.equifax.com','family.equifax.com','fastpathmodeling.equifax.com','fedsso.equifax.com','fedsso.ext.gslb.us.equifax.com','fedssoqa.ext.gslb.us.equifax.com','fin1.fin.equifax.com','firstsearch.equifax.com','fraudalerts.equifax.com','freeze.equifax.com','frsso.equifax.com','ftp.ifs.equifax.com','gcp-aus-southeast1-dev-microservices.ext.gslb.au.equifax.com','gcp-aus-southeast1-load-microservices.ext.gslb.au.equifax.com','gcp-aus-southeast1-microservices.ext.gslb.au.equifax.com','gcp-aus-southeast1-qa-microservices.ext.gslb.au.equifax.com','gcp-aus-southeast1-uat-microservices.ext.gslb.au.equifax.com','globalonline.equifax.com','go.equifax.com','gocms.fin.equifax.com','gslb-a-atl.equifax.com','gslb-a.atl.equifax.com','gslb-a.bwu.equifax.com','gslb-a.dfw.equifax.com','gslb-a.syd.equifax.com','gslink.success.equifax.com','help.equifax.com','help.widget.equifax.com','hero-kfe-pa.ifs.ext.gslb.us.equifax.com','hero-kfe.ifs.ext.gslb.us.equifax.com','hosted.ais.equifax.com','hrbtis-api-prod1.trustedid.wip.equifax.com','hrbtis-images-prod1.trustedid.wip.equifax.com','hrbtis-prod1.trustedid.wip.equifax.com','hsbc.prod.dms.equifax.com','hsbcipsec2.fin.equifax.com','ibloxgrid11.equifax.com','ibloxgrid7.equifax.com','ic-est.equifax.com','ic-est.tas.equifax.com','ic-uat-est.equifax.com','ic-uat-est.tas.equifax.com','ic-uat.equifax.com','ic-uat.tas.equifax.com','ic.equifax.com','ic.saas.equifax.com','ic.tas.equifax.com','ic.uat.uk.equifax.com','ic.uk.equifax.com','icms-creditworks.ext.gslb.au.equifax.com','icsaas-uat.equifax.com','icsaas-uat1.equifax.com','icsaas.equifax.com','icsaas.in.ext.gslb.us.equifax.com','id.equifax.com','identity-fraud-management.equifax.com','iessales.equifax.com','ifs-internal.us.equifax.com','ifs-uat-internal.us.equifax.com','ifs-uat.ca.equifax.com','ifs-uat.cl.equifax.com','ifs-uat.uk.equifax.com','ifs-uat.us.equifax.com','ifs-uat.us.ext.gslb.us.equifax.com','ifs.ca.equifax.com','ifs.cl.equifax.com','ifs.uk.equifax.com','ifs.us.equifax.com','ifs.us.ext.gslb.us.equifax.com','ifs2.ifs.us.equifax.com','ignitedirect.equifax.com','ignitemarketplace.equifax.com','ignitemarketplace.es.equifax.com','ignitemarketplace.eu.equifax.com','image.e.equifax.com','image.e.uk.equifax.com','image.notify.equifax.com','images-prod1.trustedid.wip.equifax.com','images.inform.equifax.com','images.solutions-ca.equifax.com','images.uk.partner.equifax.com','images.workforce.equifax.com','imdex-creditapps.ext.gslb.au.equifax.com','inform.equifax.com','insight.equifax.com','insightgateway-uat.equifax.com','insightgateway.equifax.com','instatouch.equifax.com','integrated.ext.prdlb.verificationservices.equifax.com','integrated.verificationservices.equifax.com','interconnect-cert.decisionportal.equifax.com','interconnect-cert.igengine.equifax.com','interconnect-lite.stl.equifax.com','interconnect-uat.decisionportal.equifax.com','interconnect-uat.decisionportal.wip.equifax.com','interconnect-uat.igengine.equifax.com','interconnect-uat.igengine.wip.equifax.com','interconnect-uat.tas.ext.gslb.us.equifax.com','interconnect.ct.equifax.com','interconnect.ct.sts.equifax.com','interconnect.decisionportal.equifax.com','interconnect.demo.equifax.com','interconnect.equifax.com','interconnect.ext.sts.equifax.com','interconnect.ext.ui.equifax.com','interconnect.igengine.equifax.com','interconnect.int9.sts.equifax.com','interconnect.int9.ui.equifax.com','interconnect.internal.sts.equifax.com','interconnect.internal.ui.equifax.com','interconnect.mutual.equifax.com','interconnect.sts.equifax.com','interconnect.tas.ext.gslb.us.equifax.com','interconnect.uat.int.equifax.com','interconnect.uat.int.sts.equifax.com','interconnect.uat.mutual.equifax.com','internal.instatouch.ext.gslb.us.equifax.com','intersections-uat.referral.equifax.com','intersections.referral.equifax.com','intersections.referral.ext.gslb.us.equifax.com','intranet.fin.equifax.com','investor.equifax.com','ipgateway-dr.equifax.com','ipgateway.equifax.com','ists.equifax.com','ists.ext.gslb.us.equifax.com','iws.equifax.com','labs.equifax.com','lead-prod1.trustedid.wip.equifax.com','learn.equifax.com','ll-prod1.trustedid.wip.equifax.com','ll-prod3.trustedid.wip.equifax.com','load.lockandalert.equifax.com','load.lockandalert.ext.gslb.us.equifax.com','load.microservices.equifax.com','load.microservices.ext.gslb.au.equifax.com','load.ms.icsaas.equifax.com','load.ms.icsaas.ext.gslb.us.equifax.com','load.ui.attcrsm.icsaas.equifax.com','load.ui.attcrsm.icsaas.ext.gslb.us.equifax.com','localhost.e.equifax.com','localhost.e.uk.equifax.com','lockandalert.equifax.com','lockandalert.ext.gslb.us.equifax.com','lr-uat.equifax.com','lsrp.equifax.com','lsweb.equifax.com',
    'lyncdiscover.equifax.com','m.equifax.com','ma.prod.dms.equifax.com','ma.qa100.dms.equifax.com','ma.staging.dms.equifax.com','mail.ebanking.equifax.com','mail.equifax.com','mail01.inform.equifax.com','mail01.solutions-ca.equifax.com','mail01.uk.partner.equifax.com','mail01.workforce.equifax.com','mail02.inform.equifax.com','mail02.workforce.equifax.com','mail03.inform.equifax.com','mail03.workforce.equifax.com','mailengine.equifax.com','mailext.ext.gslb.us.equifax.com','mailout.equifax.com','marketplace.equifax.com','meet.equifax.com','merchantc1.equifax.com','merchantc2.equifax.com','merchantc4.equifax.com','mft.equifax.com','mft1-ext.equifax.com','mft1.equifax.com','mft2-ext.equifax.com','mft2-ext.ext.gslb.us.equifax.com','mft2.equifax.com','mft2.ext.gslb.us.equifax.com','microservices.ext.gslb.au.equifax.com','microservices.ext.gslb.us.equifax.com','mint-images-prod1.trustedid.wip.equifax.com','mint-prod1.trustedid.wip.equifax.com','mixfeconatl.snr.equifax.com','mixfesenatl.snr.equifax.com','mmoc.icsaas.equifax.com','mmoc.icsaas.ext.gslb.us.equifax.com','mobilegis.equifax.com','mockicappclient.ca.equifax.com','mortgage.equifax.com','ms.attcrsm.icsaas.ext.gslb.us.equifax.com','mta.e.equifax.com','mta.e.uk.equifax.com','mta.notify.equifax.com','mta2.e.equifax.com','mta3.e.equifax.com','mutual.consumer.equifax.com','mutual.uatpsol.equifax.com','my-test.ext.gslb.au.equifax.com','my.equifax.com','my.ext.gslb.au.equifax.com','my.ext.gslb.us.equifax.com','myservices.equifax.com','naas.equifax.com','navyfederal.saas.ext.gslb.us.equifax.com','news.equifax.com','nextgen-dr.equifax.com','nextgen.equifax.com','nocheck.equifax.com','nonprodapi.baas.ext.gslb.us.equifax.com','not-found.equifax.com','notesatl1.fin.equifax.com','notesatl3.fin.equifax.com','notescolorado1.fin.equifax.com','noteshub1.fin.equifax.com','notesmichigan1.fin.equifax.com','noteswetc11.fin.equifax.com','noteswetc12.fin.equifax.com','noteswetc13.fin.equifax.com','noteswetc4.fin.equifax.com','npe-decisionpoint3.ext.gslb.au.equifax.com','ns0.equifax.com','ns1.equifax.com','ns1.prdlb.verificationservices.equifax.com','ns2.equifax.com','ns2.prdlb.verificationservices.equifax.com','odi.equifax.com','orgcert-renewal-demo.equifax.com','orgcert-renewal.equifax.com','pa.microservices.ext.gslb.au.equifax.com','padev.us.ext.gslb.us.equifax.com','pages.e.equifax.com','pages.e.uk.equifax.com','pages.notify.equifax.com','partner.equifax.com','pb.equifax.com','pcm.ext.gslb.us.equifax.com','perfmon.equifax.com','pilot.ais.equifax.com','pilot.atl.ec.equifax.com','pilot2.equifax.com','ping.equifax.com','postoffice.equifax.com','prod-decisionpoint3.ext.gslb.au.equifax.com','prod.compliancesphere.equifax.com','prod.tdp.equifax.com','prod.vision.mafpe.ext.gslb.us.equifax.com','prod.vision.tdp.ext.gslb.us.equifax.com','prod2.tdp.ext.gslb.us.equifax.com','prodconnector.au.equifax.com','prodconnector.equifax.com','prototypes.equicom.equifax.com','proxy.ifs.equifax.com','pub-ifs-uat.us.equifax.com','pub-ifs-uat.us.ext.gslb.us.equifax.com','pub-ifs-uat.us.int.gslb.us.equifax.com','pub-ifs.us.equifax.com','pub-ifs.us.ext.gslb.us.equifax.com','pub-ifs.us.int.gslb.us.equifax.com','pub2-ifs-uat.us.equifax.com','pub2-ifs.us.equifax.com','pws-wlf.b2b.equifax.com','qa.atlassoa.ext.gslb.us.equifax.com','qa.lockandalert.equifax.com','qa.lockandalert.ext.gslb.us.equifax.com','qa.mock_ic_app_client.ca.equifax.com','qa.mockicappclient.ca.equifax.com','qa.ms.icsaas.equifax.com','qa.ms.icsaas.ext.gslb.us.equifax.com','qa.ui.attcrsm.icsaas.equifax.com','qa.ui.attcrsm.icsaas.ext.gslb.us.equifax.com','qaapis.equifax.com','rai2.fin.equifax.com','ravpn.eu.equifax.com','ravpn.snr.equifax.com','ravpn.snr.wip.equifax.com','ravpn2.eu.equifax.com','rbs.equifax.com','registration-my-test.ext.gslb.au.equifax.com','registration-my.ext.gslb.au.equifax.com','reseller.acis.equifax.com','reseller.acis.ext.gslb.us.equifax.com','resources.datadrivenmarketing.equifax.com','results.equifax.com','roadmap.equifax.com','roadmap.ext.gslb.us.equifax.com','rpadtest.equifax.com','salesagent.equifax.com','salesinfo.equifax.com','saleslists.equifax.com','sandbox-api.consumer.equifax.com','sandbox.instatouch.equifax.com','sareb.dr.uk.equifax.com','sareb.uat.uk.equifax.com','sareb.uk.equifax.com','sawap.equifax.com','sb.econsumer.equifax.com','sb.myservices.equifax.com','scorecentral-images-uat8.equifax.com','scorecentral-images-uat9.equifax.com','scorecentral-images.equifax.com','scorecentral-uat8.equifax.com','scorecentral-uat9.equifax.com','scorecentral.equifax.com','scorepower.econsumer.equifax.com','secure-creditworks.ext.gslb.au.equifax.com','secure-ts-vpn.equifax.com','secure.boaevsportal.equifax.com','secure.citievs.equifax.com','secure.consumer.verificationexchange.ext.gslb.au.equifax.com','secure.eeservices.equifax.com','secure.egrc.equifax.com','secure.egrc.wip.equifax.com','secure.evsportal.equifax.com',
    'secure.evssvc1.equifax.com','secure.evssvc2.equifax.com','secure.help.equifax.com','secure.instatouch.equifax.com','secure.mds.equifax.com','secure.uistateinquiry.equifax.com','secure.verifier.verificationexchange.ext.gslb.au.equifax.com','secure.virtru.equifax.com','secure.wfverify.equifax.com','secure0.vpn.ec.equifax.com','secure1.vpn.ec.equifax.com','secure2.vpn.ec.equifax.com','securetest.eeservices.equifax.com','securetest.uistateinquiry.equifax.com','securetransport.ec.equifax.com','securev2.instatouch.equifax.com','securev2.instatouch.ext.gslb.us.equifax.com','semdir.prod.dms.equifax.com','services-int.intellireal.ext.gslb.us.equifax.com','services-uat.equifax.com','services.ca.ext.gslb.us.equifax.com','services.consumer.equifax.com','services.equifax.com','services.intellireal.ext.gslb.us.equifax.com','services.uat.uk.equifax.com','services.uk.equifax.com','shop.equifax.com','simplified-idr.equifax.com','simplified.equifax.com','sip.equifax.com','sitep-test.equifax.com','sm.ignitemarketplace.es.equifax.com','sm.ignitemarketplace.eu.equifax.com','smarts.in.ext.gslb.us.equifax.com','smarts.uat.icsaas.in.ext.gslb.us.equifax.com','smtp.equifax.com','smtp0.atl.equifax.com','smtp1.atl.equifax.com','smtp1.equifax.com','smtp2.equifax.com','smtp20.equifax.com','smtp21.equifax.com','smtp22.equifax.com','snr.wip.equifax.com','social.equifax.com','socreports.equifax.com','solutions-ca.equifax.com','sp.ignitemarketplace.es.equifax.com','sp.ignitemarketplace.eu.equifax.com','sp1.ignitemarketplace.au.equifax.com','spf.equifax.com','sq.equifax.com','staging.mds.equifax.com','start-creditapps.ext.gslb.au.equifax.com','stl01.snr.equifax.com','stlgtmweb.wip.equifax.com','stlmcefg1.equifax.com','surveys.equifax.com','sydp-gtm.gslb.au.equifax.com','sydp-gtm.mgt.equifax.com.gslb.au.equifax.com','syds-gtm.gslb.au.equifax.com','syds-gtm.mgt.equifax.com.gslb.au.equifax.com','tasblog.equifax.com','tasp.interconnect.uat1.sts.equifax.com','tb1.ignitemarketplace.au.equifax.com','tb2.ignitemarketplace.au.equifax.com','tcs.equifax.com','technologyservices.equifax.com','test-ists.equifax.com','test-zipid.ext.gslb.au.equifax.com','test.complianceconnect.equifax.com','test.compliancesphere.equifax.com','test.developer.equifax.com','test.econsumer.equifax.com','test.eport.equifax.com','test.ists.equifax.com','test.ists.ext.gslb.us.equifax.com','test.microservices.ext.gslb.au.equifax.com','test.uistateinquiry.equifax.com','testapis.equifax.com','tid-prod1.trustedid.wip.equifax.com','tlshelp.equifax.com','tlsreject.equifax.com','transaction.instatouch.ext.gslb.us.equifax.com','transport4.ec.equifax.com','transport5.ec.equifax.com','transport5.ec.ext.gslb.us.equifax.com','transport7.ec.equifax.com','transport8.ec.equifax.com','ts-sandbox-api.consumer.equifax.com','ts.equifax.com','ttn-poc.equifax.com','u2.api.supplier.equifax.com','uat-api.auth-router.mobileconnect.equifax.com','uat-api.consumer.equifax.com','uat-api.digitalid.mobileconnect.equifax.com','uat-decisionpoint3.ext.gslb.au.equifax.com','uat-facta.consumer.equifax.com','uat-services.consumer.equifax.com','uat.ai.equifax.com','uat.api.mortgage.equifax.com','uat.attcrsm.icsaas.ext.gslb.us.equifax.com','uat.auth.au.equifax.com','uat.auth.ca.equifax.com','uat.auth.ext.gslb.au.equifax.com','uat.auth.stl.equifax.com','uat.auth2.ca.ext.gslb.us.equifax.com','uat.auth2.equifax.com','uat.auth2.ext.gslb.us.equifax.com','uat.auth2.in.equifax.com','uat.auth2.in.ext.gslb.us.equifax.com','uat.auth3.equifax.com','uat.auth4.ext.gslb.us.equifax.com','uat.banking.icsaas.equifax.com','uat.banking.icsaas.ext.gslb.us.equifax.com','uat.brokerage.icsaas.equifax.com','uat.brokerage.icsaas.ext.gslb.us.equifax.com','uat.cof.icsaas.ext.gslb.us.equifax.com','uat.complianceconnect.equifax.com','uat.consumer.verificationexchange.ext.gslb.au.equifax.com','uat.customerdisputeservices.equifax.com','uat.dapapphost.ca.equifax.com','uat.dapweb.ca.equifax.com','uat.ea.equifax.com','uat.equip.uk.equifax.com','uat.extranet.uk.equifax.com','uat.icsaas.in.ext.gslb.us.equifax.com','uat.ists.equifax.com','uat.ists.ext.gslb.us.equifax.com','uat.lockandalert.ext.gslb.us.equifax.com','uat.mft1-ext.equifax.com','uat.mft1.equifax.com','uat.mft2-ext.equifax.com','uat.mft2.equifax.com','uat.microservices.ext.gslb.au.equifax.com','uat.microservices.ext.gslb.us.equifax.com','uat.mmoc.icsaas.equifax.com','uat.mmoc.icsaas.ext.gslb.us.equifax.com','uat.mockicappclient.ca.equifax.com','uat.ms.attcrsm.icsaas.equifax.com','uat.ms.attcrsm.icsaas.ext.gslb.us.equifax.com','uat.navyfederal.saas.ext.gslb.us.equifax.com','uat.ui.attcrsm.icsaas.equifax.com','uat.ui.attcrsm.icsaas.ext.gslb.us.equifax.com','uat.verifier.verificationexchange.ext.gslb.au.equifax.com','uatpsol.equifax.com','ui.attcrsm.icsaas.ext.gslb.us.equifax.com','uistateinquiry.equifax.com','uk.partner.equifax.com','url2016.careeralerts.equifax.com','url4426.jobalerts.equifax.com',
    'ussolutions.equifax.com','vba.ais.equifax.com','vbatest.ais.equifax.com','vdi1.equifax.com','vdiglobal.equifax.com','vdiportal.equifax.com','ve.consumer.ext.gslb.au.equifax.com','velvetsquirrel.equicom.equifax.com','vendorconnector.au.equifax.com','vendorconnector.equifax.com','vendorconnector.uk.equifax.com','vendorportal.equifax.com','verifications.equifax.com','verifier.verificationexchange.ext.gslb.au.equifax.com','verify-optus.ext.gslb.au.equifax.com','verifytest-optus.ext.gslb.au.equifax.com','view.e.equifax.com','view.e.uk.equifax.com','view.notify.equifax.com','vpn.ec.equifax.com','vpn0.ifs.equifax.com','vpn1.ifs.equifax.com','vpnboeingfcu1.vpn.ec.equifax.com','vpnexperiandr1.vpn.ec.equifax.com','vpnfarmersinsurance1.vpn.ec.equifax.com','vpnfarmersinsurance2.vpn.ec.equifax.com','vpnfirsthorizon1.vpn.ec.equifax.com','vpnnashvilleelectric1.vpn.ec.equifax.com','vpnpaypal2.vpn.ec.equifax.com','vpnscanaservices2.vpn.ec.equifax.com','vpnunionbankchandler1.vpn.ec.equifax.com','vpnunionbankmonterey1.vpn.ec.equifax.com','vpnwashgas2.vpn.ec.equifax.com','vzt.ic-prod-sts.ext.equifax.com','vzt.ic-prod-sts.ext.ext.gslb.us.equifax.com','vzt.ic-prod-sts.ext.wip.equifax.com','vzt.ic-prod-ui.ext.equifax.com','vzt.ic-prod-ui.ext.ext.gslb.us.equifax.com','vzt.ic-prod-ui.ext.wip.equifax.com','vzt.ic-uat-sts.ext.equifax.com','vzt.ic-uat-sts.ext.ext.gslb.us.equifax.com','vzt.ic-uat-sts.ext.wip.equifax.com','vzt.ic-uat-ui.ext.equifax.com','vzt.ic-uat-ui.ext.ext.gslb.us.equifax.com','vzt.ic-uat-ui.ext.wip.equifax.com','vzw.ic-prod-sts.ext.equifax.com','vzw.ic-prod-sts.ext.ext.gslb.us.equifax.com','vzw.ic-prod-sts.ext.wip.equifax.com','vzw.ic-prod-ui.ext.equifax.com','vzw.ic-prod-ui.ext.ext.gslb.us.equifax.com','vzw.ic-prod-ui.ext.wip.equifax.com','vzw.ic-uat-sts.ext.equifax.com','vzw.ic-uat-sts.ext.ext.gslb.us.equifax.com','vzw.ic-uat-sts.ext.wip.equifax.com','vzw.ic-uat-ui.ext.equifax.com','vzw.ic-uat-ui.ext.ext.gslb.us.equifax.com','vzw.ic-uat-ui.ext.wip.equifax.com','vzw.interconnect.equifax.com','w1.interconnect-tid.equifax.com','w1.interconnect-uat.equifax.com','w1.interconnect-uat.ext.gslb.us.equifax.com','w1.interconnect.equifax.com','w1.interconnect.ext.gslb.us.equifax.com','webmail.equifax.com','webservices.econsumer.equifax.com','wetcdomino1.fin.equifax.com','wetcdssweb1.fin.equifax.com','wetcfile1.fin.equifax.com','wetcmail1.fin.equifax.com','workforce.equifax.com','workforce.ext.gslb.us.equifax.com','workforcesolutions.equifax.com','ww2.apply.equifax.com','ww2.eport.equifax.com','ww2.equifax.com','ww3.eport.equifax.com','www-travelcard-airnz.ext.gslb.au.equifax.com','www.ads.equifax.com','www.af.equifax.com','www.ai.equifax.com','www.ai.ext.gslb.us.equifax.com','www.ai.int.gslb.us.equifax.com','www.alerts.equifax.com','www.alerts.ext.gslb.us.equifax.com','www.anakam.equifax.com','www.apply.equifax.com','www.auth.vzw.ext.gslb.us.equifax.com','www.auth.vzw.wip.equifax.com','www.authtest.vzw.ext.gslb.us.equifax.com','www.authtest.vzw.wip.equifax.com','www.blog.equifax.com','www.boa-militaryloans-qa.equifax.com','www.boa-militaryloans.equifax.com','www.cdc.equifax.com','www.cdctest.equifax.com','www.commerce.ext.gslb.au.equifax.com','www.complianceconnect.equifax.com','www.compliancesphere.equifax.com','www.consumer.equifax.com','www.consumerdisputeservices.equifax.com','www.credit.equifax.com','www.creditalert.equifax.com','www.creditwatch.equifax.com','www.customerdisputeservices.equifax.com','www.dispute.equifax.com','www.dr.claims.uk.equifax.com','www.dr.insurance.uk.equifax.com','www.dr.services.uk.equifax.com','www.dr.subjectaccess.uk.equifax.com','www.dr.uk.equifax.com','www.ecommercial.equifax.com','www.econsumer-canada.equifax.com','www.econsumer.equifax.com','www.emortgage.equifax.com','www.emortgage.ext.gslb.us.equifax.com','www.eport.equifax.com','www.eportuat.ext.gslb.us.equifax.com','www.equifax.com','www.equifaxrealtimeexchange.partner.equifax.com','www.espanol.equifax.com','www.eu.equifax.com','www.extranet.uk.equifax.com','www.fraudalert.equifax.com','www.fraudalerts.equifax.com','www.freeze.equifax.com','www.freeze.ext.gslb.us.equifax.com','www.globalonline.equifax.com','www.idams.uat.uk.equifax.com','www.insight.equifax.com','www.intelligence.equifax.com','www.investigate.equifax.com','www.investigationresults.equifax.com','www.investor.equifax.com','www.learn.equifax.com','www.linkpartners.equifax.com','www.lockandalert.equifax.com','www.msmoney.equifax.com','www.my.equifax.com','www.myequifax.equifax.com','www.myservices.equifax.com','www.neworder.equifax.com','www.news.equifax.com','www.optinonlinedelivery.equifax.com','www.pb.equifax.com','www.qa100.dms.equifax.com','www.sa.equifax.com','www.social.equifax.com','www.sp.equifax.com','www.subjectaccess.uat.uk.equifax.com','www.subjectaccess.uk.equifax.com','www.techspecs.equifax.com','www.trycreditwatch.equifax.com','www.uat.equifaxrealtimeexchange.partner.equifax.com',
    'www.uat.uk.equifax.com','www.uk.equifax.com','www.usbank.equifax.com','www.vantagescore.equifax.com','www.yp.equifax.com','www01.staging.dms.equifax.com','www2.econsumer.equifax.com','wwweconsumer.equifax.com','zipid.ext.gslb.au.equifax.com','zopa.uat.uk.equifax.com','zopa.uk.equifax.com'
]

#simple logger for error detection
def callLog(msg):
    logging.basicConfig(filename='error.log', filemode='a', level=logging.INFO,
    format="%(levelname)s - %(asctime)s - %(message)s")
    logger = logging.getLogger(__name__)
    logger.info(msg)

#Class handles queries to github API
class gitQuery:
    def __init__(self):
        self.urls = []
        self.bit = 0
        self.keywords = keywords
    
    #Iterate through available API tokens
    def selectToken(self, bit):
        ACCESS_TOKENS = [#github API tokens]
        token = ACCESS_TOKENS[bit % len(ACCESS_TOKENS)]
        return Github(token)
    
    #Using keyword, generate github query and submit to Github Search API - if result is error change token and resubmit
    def sendGithubQuery(self, query):
        g = self.selectToken(self.bit)
        try:
            result = g.search_code(query, order='desc')
            print(f'Found {result.totalCount} file(s) for {query}')
            for file in result:
                url = (f'{file.download_url}')
                self.urls.append(url)

        except Exception as ex:
            callLog(ex)
            self.bit += 1
            g = self.selectToken(self.bit)
            self.sendGithubQuery(query)
    
    #def buildGitHubQuery(self, keyword):
        #for q in queries:
            #query = f'{q} {keyword} in:file extension:{args.extension}'
            #self.sendGithubQuery(query)

    def ThreadingQuery(self, keyword):
        n = len(self.keywords)
        g = self.selectToken(self.bit)
        for q in queries:
            with ThreadPoolExecutor(max_workers=n) as executor:
                query = f'{q} {keyword} in:file extension:{args.extension}'
                executor.submit(g.search_code, query, order='desc')
                self.sendGithubQuery(query)
            

            
            
    
    #Iterate through all keywords and call "sendGithubQuery"
    def loopkeywords(self):
        for word in self.keywords:
            self.ThreadingQuery(word)
        return self.urls

    
#write results to outfile
def write_results(nline):
    with open(args.outfile, 'a') as f:
        f.writelines(nline)
        f.close()

#collect the actual line from the Github URL containing the keyword found
def get_githubContents(u):
    lines = []
    newLines = []
    page = requests.get(u)
    soup = BeautifulSoup(page.content, 'html.parser')
    output = soup.prettify()
    flines = output.split("\n")
    for fline in flines:
        for keyword in keywords:
            if keyword in fline:
                lines.append(fline)
    for line in lines:
        newLines.append(F'{u}, {line}\n')
    newLines = list(dict.fromkeys(newLines))
    return newLines

#Iterate through all the URLs. See if they are already logged. If so - pass. Otherewise, collect code line from raw Github
def RepoScrape(urls):
    try:
        newlines = []
        with open(args.outfile, 'r') as f:
            olines = f.read()
            for u in urls:
                doesExist = check_doc(olines, u)
                if doesExist:
                    pass
                else:
                    newlines = get_githubContents(u)
                    newlines = list(dict.fromkeys(newlines))
                    for line in newlines:
                        write_results(line)
            f.close()
    except Exception as E:
        callLog(E)
        callLog(f"Creating document {args.outfile}")
        with open(args.outfile, 'w') as f:
            f.close()
        RepoScrape(urls)


#simple check to see if the URL exists in the outfile already
def check_doc(olines, url):
    if url in olines:
        return True
    else:
        return False


def main():
    callLog("Initializing cyberscraper tool")
    searcher = gitQuery()
    urls = searcher.loopkeywords()
    RepoScrape(urls)


if __name__ == '__main__':
    keywords = keywords
    parser = argparse.ArgumentParser(description="Scrapes Github for EFX data", usage="parser -e <extension> -k <keywordsfile")
    parser.add_argument('-e', '--extension', help="define file extension to explore (i.e., py, js, etc", 
    required=False, default='py')
    parser.add_argument('-o', '--outfile', help="define an outfile to write data to", required=False, default='git_pages.csv')
    args = parser.parse_args()
    main()
